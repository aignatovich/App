
<head>
    <link href="~/Content/jquery-ui.css" rel="stylesheet" type="text/css" />
    <link href="~/Content/themes/base/all.css" rel="stylesheet" type="text/css" />
    <link href="~/Content/jquery.jqGrid/ui.jqgrid.css" rel="stylesheet" type="text/css" />
    <script src="~/Scripts/jquery-2.1.4.min.js" type="text/javascript"></script>   
    <script src="~/Scripts/jquery-ui-1.11.4.js" type="text/javascript"></script>
    <script src="~/Scripts/jquery.jqGrid.min.js" type="text/javascript"></script>
    <script src="~/Scripts/i18n/grid.locale-en.js" type="text/javascript"></script>
</head>

<br /><br />
<div>
    <div class="well col-md-9">
        <table id="jqg"></table>
        <div id="jpager"></div>
    </div>
</div>
  
@using (Html.BeginForm("EditEmployee", "Employee", FormMethod.Get, new { @class = "", role = "" }))
{
    @Html.Hidden("Id", "", new { @id = "edit" });
    <td width="50">
        <input type="submit" id="editSubmit" value="Edit" class="btn btn-primary" style="visibility:hidden;"/>
    </td>
}  
<script type="text/javascript">
    function DeleteAction(rowId) {
             if (confirm("Are you sure you want to remove this employee?") == true) {
                 var dataFromTheRow = $("#jqg").jqGrid('getRowData', rowId);;
                 $.ajax({
                     type: "POST",
                     url: "/Employee/RemoveEmployee",
                     data: { id: dataFromTheRow.Id },
                     datatype: "html",
                     success: function (data) {
                         $('#jqg').jqGrid('delRowData', rowId);
                     }
                 });
             } else {
                 return false;
             }    
    }

    function EditAction(rowId) {
        if (confirm("Are you sure you want to edit this employee?") == true) {
            var dataFromTheRow = $("#jqg").jqGrid('getRowData', rowId);;
            var del = $('#edit');
            del.val(dataFromTheRow.Id);
            var o = $('#editSubmit');
            o.click();
        } else {
            return false;
        }
    }

    (function () {
        $("#jqg").jqGrid({
            url: '@Url.Action("GetEmployeeData")',
            datatype: "json",
            colNames: ['Id', 'Position', 'Name', 'Surname', '',''],
            colModel: [
            { name: 'Id', label: 'Id', width: 30, stype: 'text' },
            { name: 'Position', label: 'Position', width: 50, sortable: true },
            { name: 'Name', index: 'Name', width: 50, sortable: true },
            { name: 'Surname', label: 'Surname', width: 50, sortable: true },
            {

              width:14,
              formatter: function (cellvalue, options, rowObject) {
                  return ' <span class="glyphicon glyphicon-remove-circle btn btn-primary" title="click to open" onclick="DeleteAction(' + options.rowId + ');"></span>';
              },              
            },
            {
                width: 13,
                formatter: function (cellvalue, options, rowObject) {
                    return '<span class="glyphicon glyphicon glyphicon-pencil btn btn-primary" title="click to open" onclick="EditAction(' + options.rowId + ');"></span>';
                }
            }
            ],
            rowNum: 99,
            loadonce: true,
            sortname: 'Id',
            sortorder: "desc",
            caption: "Employee list",
            gridview: true,
            width: 780,
            height: 750,
            pageable: true,
            pager: '#jpager',
            jsonReader: { repeatitems: false, root: function (obj) { return obj; } },

        });

    })();



</script>
